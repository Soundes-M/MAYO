#include "mayo.h"
#include "xparameters.h"
#include "mayo_axi_litev3.h"

MAYO_StatusTypeDef
MayoStartKeygen (MAYO_ContextTypeDef* ctx, int isDebug, int enIRQ, int isExpose) {

  ctx->CR = (MAYO_ControlRegiter)MAYO_AXI_LITEV3_mReadReg(XPAR_MAYO_AXI_LITEV3_0_S00_AXI_BASEADDR, MAYO_AXI_LITEV3_S00_AXI_SLV_REG1_OFFSET);

  ctx->CR.KeygenEnable = 0x1;
  ctx->CR.SignEnable = 0x0;
  ctx->CR.VerifyEnable = 0x0;

  if (isDebug)
  {
    ctx->CR.DebugEnable = 0x1;
  }
  else
    ctx->CR.DebugEnable = 0x0;

  if (enIRQ)
    ctx->CR.IRQEnable = 0x1;
  else
    ctx->CR.IRQEnable = 0x0;

  if (isExpose)
    ctx->CR.ExposeEnable = 0x1;
  else
    ctx->CR.ExposeEnable = 0x0;

  //MAYO_AXI_LITEV3_mWriteReg(XPAR_MAYO_AXI_LITEV3_0_S00_AXI_BASEADDR, MAYO_AXI_LITEV3_S00_AXI_SLV_REG1_OFFSET, ctx->CR);

  MAYO_StatusTypeDef ret = MAYO_ERROR;

  return ret;
}
//MAYO_StatusTypeDef MayoKeygenIsFinished(MAYO_ContextTypeDef* ctx);
